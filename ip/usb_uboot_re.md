# usb RE for u-boot

## log

```
SigmaStar # usb start
(Re)start USB...
Check USB port[0]:
[USB] usb_lowlevel_init++
[USB] USB EHCI LIB VER: 2018.01.12
[USB] Port 0 is Enabled
[USB] TV_usb_init (UTMI Init) ++
[USB] UTMI Base 1f284200
[USB] UHC Base 1f284800
[USB] USBC Base 1f284600
[USB] BC Base 1f284400
[USB] config miu select [70] [f8] [ef] ][ef]
[USB] enable miu lower bound address subtraction
[USB] init squelch level 0x2
[USB] TV_usb_init--
[USB] Usb_host_Init++
[USB] Async base addr: 0x3f78a80 
[USB] Reg 0x28: 0x8a80 0x3f7
[USB] disable run
[USB] Host Speed:2 
[USB] enable aynch 
[USB] Usb_host_Init--
[USB] usb_lowlevel_init--
scanning bus for devices... 
[USB] interface[0] conf:1 value ff: 
1 USB Device(s) found
       scanning usb for storage devices... 0 Storage Device(s) found
SigmaStar # usb tree
USB device tree:
  1  Vendor specific (12 Mb/s, 350mA)
     Realtek USB 10/100/1000 LAN 001000001
   
SigmaStar #
```

## before/after

#### utmi

```
SigmaStar # md.w 0x1f284200 0x100
1f284200: 7f03 0000 2084 0000 3060 0000 3020 0000    ..... ..`0.. 0..
1f284210: 0426 0000 8040 0000 00c0 0000 0000 0000    &...@...........
1f284220: 0040 0000 00ff 0000 400b 0000 0000 0000    @........@......
1f284230: 23cc 0000 0000 0000 0000 0000 0000 0000    .#..............
1f284240: 8051 0000 2088 0000 0200 0000 0000 0000    Q.... ..........
1f284250: 0000 0000 0060 0000 0000 0000 0001 0000    ....`...........
1f284260: 1419 0000 0000 0000 0000 0000 0001 0000    ................
1f284270: e801 0000 0000 0000 7c02 0000 0000 0000    .........|......
1f284280: 0009 0000 0080 0000 0000 0000 0700 0000    ................
1f284290: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284300: 7f03 0000 2084 0000 3060 0000 3020 0000    ..... ..`0.. 0..
1f284310: 0426 0000 8040 0000 00c0 0000 0000 0000    &...@...........
1f284320: 0040 0000 00ff 0000 400b 0000 0000 0000    @........@......
1f284330: 23cc 0000 0000 0000 0000 0000 0000 0000    .#..............
1f284340: 8051 0000 2088 0000 0200 0000 0000 0000    Q.... ..........
1f284350: 0000 0000 0060 0000 0000 0000 0001 0000    ....`...........
1f284360: 1419 0000 0000 0000 0000 0000 0001 0000    ................
1f284370: e801 0000 0000 0000 7c02 0000 0000 0000    .........|......
1f284380: 0009 0000 0080 0000 0000 0000 0700 0000    ................
1f284390: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```

```
SigmaStar # md.w 0x1f284200 0x100
1f284200: 0001 0000 2c84 0000 3060 0000 3040 0000    .....,..`0..@0..
1f284210: 852e 0000 8040 0000 00c0 0000 8040 0000    ....@.......@...
1f284220: 0040 0000 00ff 0000 600b 0000 0000 0000    @........`......
1f284230: 23cc 0000 0000 0000 0000 0000 0000 0000    .#..............
1f284240: 8051 0000 2088 0000 0200 0000 0000 0000    Q.... ..........
1f284250: 0000 0000 0062 0000 0210 0000 8100 0000    ....b...........
1f284260: 0419 0000 0000 0000 0000 0000 0001 0000    ................
1f284270: e801 0000 0000 0000 7dd2 0000 8000 0000    .........}......
1f284280: 0009 0000 0080 0000 0000 0000 0700 0000    ................
1f284290: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2842f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284300: 0001 0000 2c84 0000 3060 0000 3040 0000    .....,..`0..@0..
1f284310: 852e 0000 8040 0000 00c0 0000 8040 0000    ....@.......@...
1f284320: 0040 0000 00ff 0000 600b 0000 0000 0000    @........`......
1f284330: 23cc 0000 0000 0000 0000 0000 0000 0000    .#..............
1f284340: 8051 0000 2088 0000 0200 0000 0000 0000    Q.... ..........
1f284350: 0000 0000 0062 0000 0210 0000 8100 0000    ....b...........
1f284360: 0419 0000 0000 0000 0000 0000 0001 0000    ................
1f284370: e801 0000 0000 0000 7dd2 0000 8000 0000    .........}......
1f284380: 0009 0000 0080 0000 0000 0000 0700 0000    ................
1f284390: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2843f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```

### UHC

```
```

### USBC

```
SigmaStar # md.w 0x1f284600 0x100
1f284600: 0228 0000 0040 0000 0040 0000 0702 0000    (...@...@.......
1f284610: 4042 0000 83c0 0000 0000 0000 5000 0000    B@...........P..
1f284620: 0200 0000 0080 0000 0000 0000 0000 0000    ................
1f284630: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284640: 0010 0000 0000 0000 0000 0000 0000 0000    ................
1f284650: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284660: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284670: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284680: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284690: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284700: 0228 0000 0040 0000 0040 0000 0702 0000    (...@...@.......
1f284710: 4042 0000 83c0 0000 0000 0000 5000 0000    B@...........P..
1f284720: 0200 0000 0080 0000 0000 0000 0000 0000    ................
1f284730: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284740: 0010 0000 0000 0000 0000 0000 0000 0000    ................
1f284750: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284760: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284770: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284780: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284790: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```

```
SigmaStar # md.w 0x1f284600 0x100
1f284600: 0228 0000 0541 0000 0040 0000 0702 0000    (...A...@.......
1f284610: 4002 0000 83c0 0000 0000 0000 5900 0000    .@...........Y..
1f284620: 0203 0000 0180 0000 0070 0000 eff8 0000    ........p.......
1f284630: 01ef 0000 0000 0000 0000 0000 0000 0000    ................
1f284640: 0017 0000 0000 0000 0000 0000 0000 0000    ................
1f284650: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284660: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284670: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284680: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284690: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2846f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284700: 0228 0000 0541 0000 0040 0000 0702 0000    (...A...@.......
1f284710: 4002 0000 83c0 0000 0000 0000 5900 0000    .@...........Y..
1f284720: 0203 0000 0180 0000 0070 0000 eff8 0000    ........p.......
1f284730: 01ef 0000 0000 0000 0000 0000 0000 0000    ................
1f284740: 0017 0000 0000 0000 0000 0000 0000 0000    ................
1f284750: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284760: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284770: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284780: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f284790: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2847f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```

our u-boot before usb start 

```
=> md.w 0x1f284600 0x100
1f284600: 0228 0000 0040 0000 0040 0000 0702 0000  (...@...@.......
1f284610: 0042 0000 83c0 0000 0000 0000 5000 0000  B............P..
1f284620: 0200 0000 0080 0000 0000 0000 0000 0000  ................
1f284630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284640: 0010 0000 0000 0000 0000 0000 0000 0000  ................
1f284650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2846a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2846b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2846c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2846d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2846e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2846f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284700: 0228 0000 0040 0000 0040 0000 0702 0000  (...@...@.......
1f284710: 0042 0000 83c0 0000 0000 0000 5000 0000  B............P..
1f284720: 0200 0000 0080 0000 0000 0000 0000 0000  ................
1f284730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284740: 0010 0000 0000 0000 0000 0000 0000 0000  ................
1f284750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f284790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2847a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2847b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2847c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2847d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2847e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
1f2847f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```
